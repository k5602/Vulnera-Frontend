---
// MatrixBackground.astro - Reusable Matrix Theme Background Component
// Provides layered cyberpunk/matrix-style background effects

export interface Props {
  /** Matrix rain effect opacity (0-1) */
  rainOpacity?: number;
  /** Enable/disable the matrix rain effect */
  showRain?: boolean;
  /** Enable/disable the cyber grid overlay */
  showCyberGrid?: boolean;
  /** Enable/disable the terminal green glow gradient */
  showTerminalGlow?: boolean;
  /** Variant for different background intensities */
  variant?: 'subtle' | 'normal' | 'intense';
  /** Custom CSS classes to add to the container */
  class?: string;
  /** Z-index value for the background container */
  zIndex?: number;
}

const {
  rainOpacity = 0.3,
  showRain = true,
  showCyberGrid = true,
  showTerminalGlow = true,
  variant = 'normal',
  class: className = '',
  zIndex = 0
} = Astro.props;

// Opacity values based on variant
const opacityMap = {
  subtle: {
    rain: Math.min(rainOpacity * 0.5, 0.15),
    cyberGrid: 0.4,
    terminalGlow: 0.6
  },
  normal: {
    rain: rainOpacity,
    cyberGrid: 0.8,
    terminalGlow: 0.8
  },
  intense: {
    rain: Math.min(rainOpacity * 1.5, 1),
    cyberGrid: 1,
    terminalGlow: 1
  }
};

const opacities = opacityMap[variant];
---

<!-- Matrix Theme Background Container -->
<div 
  class={`absolute inset-0 ${className}`}
  style={`z-index: ${zIndex};`}
  role="presentation"
  aria-hidden="true"
>
  <!-- Matrix Rain Effect -->
  {showRain && (
    <div 
      class="absolute inset-0 matrix-rain"
      style={`opacity: ${opacities.rain};`}
    ></div>
  )}
  
  <!-- Cyber Grid Overlay -->
  {showCyberGrid && (
    <div 
      class="absolute inset-0 bg-gradient-to-r from-black via-black/80 to-black/60"
      style={`opacity: ${opacities.cyberGrid};`}
    ></div>
  )}
  
  <!-- Terminal Green Glow -->
  {showTerminalGlow && (
    <div 
      class="absolute inset-0 bg-gradient-to-b from-transparent via-matrix-900/20 to-black/80"
      style={`opacity: ${opacities.terminalGlow};`}
    ></div>
  )}
</div>